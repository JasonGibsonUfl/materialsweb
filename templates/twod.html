{% load static %}

<head>
    <title>2D Materials</title>
    <link rel="icon" href="{% static 'Black_Icon.png' %}" sizes="16x16">
    <link rel="stylesheet" type="text/css"
        href="{% static 'queries/dbstyle.css' %}" />
    <link rel="stylesheet" href="{% static 'queries/sortable-theme-dark.css' %}" />
    <link href='https://fonts.googleapis.com/css?family=Nunito:300'
        rel='stylesheet' type='text/css'>
</head>

<body onload="displayResults();">
  <div id="TopBar" style="background-color: white; position: absolute; top: 0; height: 125px; width: 100%; opacity: 0.9;"></div>

    <div id="HomePageHeaderBox">

        <a href="/">
            <img src="{% static "Icon.png" %}" id="Icon" style="display: inline; width: 102; height: 115; position: relative; top: 2px; left: 42px;"/>
        </a>
        <h1 id="HomePageHeader">2D Materials</h1>
        <div id="Menu">
            <a class="hvr-float-shadow" href="/">Home</a>
            <a class="hvr-float-shadow" href="/about">About</a>
            <a class="hvr-float-shadow" href="/docs">Docs</a>
            <a class="hvr-float-shadow" href="/contact">Contact</a>
            <a class="hvr-float-shadow" href="/api" id="Api">API</a>
            {% if is_signed_in %}
              <a class="hvr-float-shadow" href="/logout" id="SignOut">Sign Out</a>
            {% else %}
              <a class="hvr-float-shadow" href="/login" id="SignOut">Sign In</a>
            {% endif %}
        </div>
    </div>

    <script type="text/javascript" src="{% static "3Dmol/jquery.js" %}">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="{% static "parallax.js" %}"></script>
    <script src="{% static "3Dmol/3Dmol-nojquery-min.js" %}"></script>

    <script>
    function add(ev) {
        var elt_name = (ev.target.id + "-");
        var formulabox = document.getElementById("FormulaBox");
        var oldformula = formulabox.value;
        if (oldformula.indexOf(elt_name) != -1) {
            formulabox.value = oldformula.replace(elt_name,"");
            document.getElementById(ev.target.id).style.backgroundColor = "#454343";
        } else {
            formulabox.value = (oldformula + elt_name);
            document.getElementById(ev.target.id).style.backgroundColor = "#fcb040";
        }
    }
    </script>

    <script>
    function displayResults() {
        alert("ACT");
        var all_results = {{ all_results }};
        var table = document.getElementById("tableBody");

        if (all_results.length) {

          for ( var i=0, len = all_results.length; i < len; i++ ) {
            new_option = document.createElement("a");
            formula = all_results[i].split(" ")[0];
            mwid = all_results[i].split(" ")[1];
            spacegroup = all_results[i].split(" ")[2];
            numSites = Number(all_results[i].split(" ")[3]);
            bandGap = Number(all_results[i].split(" ")[4]);
            theoryLevel = all_results[i].split(" ")[5];

            new_option.id = mwid;
            var optionText = document.createTextNode(mwid);
            new_option.appendChild(optionText);
            new_option.href = "/twodmaterials/result/" + new_option.id;
            new_option.target = "_blank";
            new_option.style.color = "white";
            new_option.addEventListener("mouseover", function (ev) {ev.target.style.color = "#fcb040"});
            new_option.addEventListener("mouseout", function (ev) {ev.target.style.color = "white"});

            var row = document.createElement("tr");
            table.appendChild(row);
            var mwidCell = document.createElement("td");
            row.appendChild(mwidCell);
            mwidCell.style.width= '150px';
            var formulaCell = document.createElement("td");
            row.appendChild(formulaCell);
            var spacegroupCell = document.createElement("td");
            row.appendChild(spacegroupCell);
            var numSitesCell = document.createElement("td");
            row.appendChild(numSitesCell);
            var bandGapCell = document.createElement("td");
            row.appendChild(bandGapCell);
            var theoryLevelCell = document.createElement("td");
            row.appendChild(theoryLevelCell);

            mwidCell.appendChild(new_option);
            formulaCell.innerHTML = formula;
            spacegroupCell.innerHTML = spacegroup;
            numSitesCell.innerHTML = numSites;
            bandGapCell.innerHTML = bandGap;
            theoryLevelCell.innerHTML = theoryLevel;

            var tds = document.getElementsByTagName('td');

//            for (var j = 0; j < tds.length; j++)
//                tds[j].style.width = '150px';

          }
        } else {
            document.getElementById('noResultsModal').style.display = "block";
        };
    }
    </script>

    <div class="live_element" style="left: 50px; top: 180px;" id="H" onclick="add(event)">H</div>
    <div class="live_element" style="left: 50px; top: 235px;" id="Li" onclick="add(event)">Li</div>
    <div class="live_element" style="left: 50px; top: 290px;" id="Na" onclick="add(event)">Na</div>
    <div class="live_element" style="left: 50px; top: 345px;" id="K" onclick="add(event)">K</div>
    <div class="live_element" style="left: 50px; top: 400px;" id="Rb" onclick="add(event)">Rb</div>
    <div class="live_element" style="left: 50px; top: 455px;" id="Cs" onclick="add(event)">Cs</div>

    <div class="live_element" style="left: 105px; top: 235px;" id="Be" onclick="add(event)">Be</div>
    <div class="live_element" style="left: 105px; top: 290px;" id="Mg" onclick="add(event)">Mg</div>
    <div class="live_element" style="left: 105px; top: 345px;" id="Ca" onclick="add(event)">Ca</div>
    <div class="live_element" style="left: 105px; top: 400px;" id="Sr" onclick="add(event)">Sr</div>
    <div class="live_element" style="left: 105px; top: 455px;" id="Ba" onclick="add(event)">Ba</div>

    <div class="live_element" style="left: 160px; top: 345px;" id="Sc" onclick="add(event)">Sc</div>
    <div class="live_element" style="left: 160px; top: 400px;" id="Y" onclick="add(event)">Y</div>
    <div class="placeholder" style="left: 160px; top: 455px;" id="La_placeholder">La</div>
    <div class="live_element" style="left: 160px; top: 530px;" id="La" onclick="add(event)">La</div>
    <div class="live_element" style="left: 160px; top: 585px;" id="Ac" onclick="add(event)">Ac</div>

    <div class="live_element" style="left: 215px; top: 345px;" id="Ti" onclick="add(event)">Ti</div>
    <div class="live_element" style="left: 215px; top: 400px;" id="Zr" onclick="add(event)">Zr</div>
    <div class="live_element" style="left: 215px; top: 455px;" id="Hf" onclick="add(event)">Hf</div>
    <div class="live_element" style="left: 215px; top: 530px;" id="Ce" onclick="add(event)">Ce</div>
    <div class="live_element" style="left: 215px; top: 585px;" id="Th" onclick="add(event)">Th</div>

    <div class="live_element" style="left: 270px; top: 345px;" id="V" onclick="add(event)">V</div>
    <div class="live_element" style="left: 270px; top: 400px;" id="Nb" onclick="add(event)">Nb</div>
    <div class="live_element" style="left: 270px; top: 455px;" id="Ta" onclick="add(event)">Ta</div>
    <div class="live_element" style="left: 270px; top: 530px;" id="Pr" onclick="add(event)">Pr</div>
    <div class="live_element" style="left: 270px; top: 585px;" id="Pa" onclick="add(event)">Pa</div>

    <div class="live_element" style="left: 325px; top: 345px;" id="Cr" onclick="add(event)">Cr</div>
    <div class="live_element" style="left: 325px; top: 400px;" id="Mo" onclick="add(event)">Mo</div>
    <div class="live_element" style="left: 325px; top: 455px;" id="W" onclick="add(event)">W</div>
    <div class="live_element" style="left: 325px; top: 530px;" id="Nd" onclick="add(event)">Nd</div>
    <div class="live_element" style="left: 325px; top: 585px;" id="U" onclick="add(event)">U</div>

    <div class="live_element" style="left: 380px; top: 345px;" id="Mn" onclick="add(event)">Mn</div>
    <div class="dead_element" style="left: 380px; top: 400px;" id="Tc">Tc</div>
    <div class="live_element" style="left: 380px; top: 455px;" id="Re" onclick="add(event)">Re</div>
    <div class="live_element" style="left: 380px; top: 530px;" id="Pm" onclick="add(event)">Pm</div>
    <div class="live_element" style="left: 380px; top: 585px;" id="Np" onclick="add(event)">Np</div>

    <div class="live_element" style="left: 435px; top: 345px;" id="Fe" onclick="add(event)">Fe</div>
    <div class="live_element" style="left: 435px; top: 400px;" id="Ru" onclick="add(event)">Ru</div>
    <div class="live_element" style="left: 435px; top: 455px;" id="Os" onclick="add(event)">Os</div>
    <div class="live_element" style="left: 435px; top: 530px;" id="Sm" onclick="add(event)">Sm</div>
    <div class="live_element" style="left: 435px; top: 585px;" id="Pu" onclick="add(event)">Pu</div>

    <div class="live_element" style="left: 490px; top: 345px;" id="Co" onclick="add(event)">Co</div>
    <div class="live_element" style="left: 490px; top: 400px;" id="Rh" onclick="add(event)">Rh</div>
    <div class="live_element" style="left: 490px; top: 455px;" id="Ir" onclick="add(event)">Ir</div>
    <div class="live_element" style="left: 490px; top: 530px;" id="Eu" onclick="add(event)">Eu</div>
    <div class="dead_element" style="left: 490px; top: 585px;" id="Am">Am</div>

    <div class="live_element" style="left: 545px; top: 345px;" id="Ni" onclick="add(event)">Ni</div>
    <div class="live_element" style="left: 545px; top: 400px;" id="Pd" onclick="add(event)">Pd</div>
    <div class="live_element" style="left: 545px; top: 455px;" id="Pt" onclick="add(event)">Pt</div>
    <div class="live_element" style="left: 545px; top: 530px;" id="Gd" onclick="add(event)">Gd</div>
    <div class="dead_element" style="left: 545px; top: 585px;" id="Cm">Cm</div>

    <div class="live_element" style="left: 600px; top: 345px;" id="Cu" onclick="add(event)">Cu</div>
    <div class="live_element" style="left: 600px; top: 400px;" id="Ag" onclick="add(event)">Ag</div>
    <div class="live_element" style="left: 600px; top: 455px;" id="Au" onclick="add(event)">Au</div>
    <div class="live_element" style="left: 600px; top: 530px;" id="Tb" onclick="add(event)">Tb</div>
    <div class="dead_element" style="left: 600px; top: 585px;" id="Bk">Bk</div>

    <div class="live_element" style="left: 655px; top: 345px;" id="Zn" onclick="add(event)">Zn</div>
    <div class="live_element" style="left: 655px; top: 400px;" id="Cd" onclick="add(event)">Cd</div>
    <div class="live_element" style="left: 655px; top: 455px;" id="Hg" onclick="add(event)">Hg</div>
    <div class="live_element" style="left: 655px; top: 530px;" id="Dy" onclick="add(event)">Dy</div>
    <div class="dead_element" style="left: 655px; top: 585px;" id="Cf">Cf</div>

    <div class="live_element" style="left: 710px; top: 235px;" id="B" onclick="add(event)">B</div>
    <div class="live_element" style="left: 710px; top: 290px;" id="Al" onclick="add(event)">Al</div>
    <div class="live_element" style="left: 710px; top: 345px;" id="Ga" onclick="add(event)">Ga</div>
    <div class="live_element" style="left: 710px; top: 400px;" id="In" onclick="add(event)">In</div>
    <div class="live_element" style="left: 710px; top: 455px;" id="Tl" onclick="add(event)">Tl</div>
    <div class="live_element" style="left: 710px; top: 530px;" id="Ho" onclick="add(event)">Ho</div>
    <div class="dead_element" style="left: 710px; top: 585px;" id="Es">Es</div>

    <div class="live_element" style="left: 765px; top: 235px;" id="C" onclick="add(event)">C</div>
    <div class="live_element" style="left: 765px; top: 290px;" id="Si" onclick="add(event)">Si</div>
    <div class="live_element" style="left: 765px; top: 345px;" id="Ge" onclick="add(event)">Ge</div>
    <div class="live_element" style="left: 765px; top: 400px;" id="Sn" onclick="add(event)">Sn</div>
    <div class="live_element" style="left: 765px; top: 455px;" id="Pb" onclick="add(event)">Pb</div>
    <div class="live_element" style="left: 765px; top: 530px;" id="Er" onclick="add(event)">Er</div>
    <div class="dead_element" style="left: 765px; top: 585px;" id="Fm">Fm</div>

    <div class="live_element" style="left: 820px; top: 235px;" id="N" onclick="add(event)">N</div>
    <div class="live_element" style="left: 820px; top: 290px;" id="P" onclick="add(event)">P</div>
    <div class="live_element" style="left: 820px; top: 345px;" id="As" onclick="add(event)">As</div>
    <div class="live_element" style="left: 820px; top: 400px;" id="Sb" onclick="add(event)">Sb</div>
    <div class="live_element" style="left: 820px; top: 455px;" id="Bi" onclick="add(event)">Bi</div>
    <div class="live_element" style="left: 820px; top: 530px;" id="Tm" onclick="add(event)">Tm</div>
    <div class="dead_element" style="left: 820px; top: 585px;" id="Md">Md</div>

    <div class="live_element" style="left: 875px; top: 235px;" id="O" onclick="add(event)">O</div>
    <div class="live_element" style="left: 875px; top: 290px;" id="S" onclick="add(event)">S</div>
    <div class="live_element" style="left: 875px; top: 345px;" id="Se" onclick="add(event)">Se</div>
    <div class="live_element" style="left: 875px; top: 400px;" id="Te" onclick="add(event)">Te</div>
    <div class="dead_element" style="left: 875px; top: 455px;" id="Po">Po</div>
    <div class="live_element" style="left: 875px; top: 530px;" id="Yb" onclick="add(event)">Yb</div>
    <div class="dead_element" style="left: 875px; top: 585px;" id="No">No</div>

    <div class="live_element" style="left: 930px; top: 235px;" id="F" onclick="add(event)">F</div>
    <div class="live_element" style="left: 930px; top: 290px;" id="Cl" onclick="add(event)">Cl</div>
    <div class="live_element" style="left: 930px; top: 345px;" id="Br" onclick="add(event)">Br</div>
    <div class="live_element" style="left: 930px; top: 400px;" id="I" onclick="add(event)">I</div>
    <div class="dead_element" style="left: 930px; top: 455px;" id="At">At</div>
    <div class="live_element" style="left: 930px; top: 530px;" id="Lu" onclick="add(event)">Lu</div>
    <div class="dead_element" style="left: 930px; top: 585px;" id="Lr">Lr</div>

    <div class="dead_element" style="left: 985px; top: 180px;" id="He">He</div>
    <div class="dead_element" style="left: 985px; top: 235px;" id="Ne">Ne</div>
    <div class="dead_element" style="left: 985px; top: 290px;" id="Ar">Ar</div>
    <div class="dead_element" style="left: 985px; top: 345px;" id="Kr">Kr</div>
    <div class="dead_element" style="left: 985px; top: 400px;" id="Xe">Xe</div>
    <div class="dead_element" style="left: 985px; top: 455px;" id="Rn">Rn</div>

    <table data-sortable class="sortable-theme-dark" style="position: relative; top: 450px; left: 50px;">
      <thead>
        <tr>
            <th style="cursor: pointer; width: 100px;">Material ID</th>
            <th style="cursor: pointer; width: 120px;">Formula</th>
            <th style="cursor: pointer; width: 150px;">Spacegroup</th>
            <th style="cursor: pointer; width: 120px;"># Atoms</th>
            <th style="cursor: pointer; width: 150px;">Band Gap (eV)</th>
            <th style="cursor: pointer; width: 100px;">XC Level</th>
        </tr>
      </thead>
      <tbody id="tableBody">
      </tbody>
    </table>

    <form method="post">{% csrf_token %}
        <input type="text" id="FormulaBox" name="FormulaBox" class="formulabox"
            placeholder="'Ca-I', 'V2O5', 'mw-40', or mpquery">
        <input type="submit" value="Submit" name="Submit" id="Submit">
    </form>
    <!-- Trigger/Open The Modal -->
    <button id="Help">[Help]</button>
    <a id="Templates" href="/twodmaterials/templates"
     style="position: absolute; color: #fcb040; top: 149px; left: 800px; font-size: 30px;">[Templates]</a>

    <!-- The Modal -->
    <div id="helpModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close" id="closeHelp">X</span>
        <p>There are several ways to query the database:</p>
        <p>1. Click on elements to search for a general composition</p>
        <p>2. Enter a specific formula</p>
        <p>3. Enter a material id (mw-####)</p>
        <p>4. Enter an mpquery (dictionary-style search). For example, entering
          {} will return all materials in the database. Entering
          {'elements':{'$in':['Y']}} will return all materials that contain Y.
          Please see the <a style="color: #fcb040; font-size: 16;" target="_blank" href="https://github.com/materialsproject/mapidoc">
          Materials Project API documentation</a> for more details on the
          mpquery syntax.</p>
      </div>
    </div>

    <div id="noResultsModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close" id="closeNoResults">X</span>
        <p>No results found.</p>
      </div>
    </div>

    <script>
    // Get the modal
    var helpModal = document.getElementById('helpModal');
    var noResultsModal = document.getElementById('noResultsModal');

    // Get the button that opens the modal
    var helpBtn = document.getElementById("Help");

    // Get the <span> element that closes the modal
    var closeHelp = document.getElementById("closeHelp");
    var closeNoResults = document.getElementById("closeNoResults");

    // When the user clicks on the help button, open the help modal
    helpBtn.onclick = function() {
        helpModal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    closeHelp.onclick = function() {
        helpModal.style.display = "none";
    }
    closeNoResults.onclick = function() {
        noResultsModal.style.display = "none"
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == helpModal) {
            helpModal.style.display = "none";
        }
        else if (event.target == noResultsModal) {
            noResultsModal.style.display = "none"
        }
    }
    </script>

    <form id="FinalForm" method="post">{% csrf_token %}
      <input type="text" id="FinalSelection" name="FinalSelection" style="display: none"/>
    </form>

    <div id="Footer"><div>

    <script src="{% static 'install.js' %}"></script>
    <script src="{% static 'sortable.js' %}"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85193239-1', 'auto');
      ga('send', 'pageview');

    </script>

</body>
